variables:
  backendImageName: quay.io/anonlink-test #data61/anonlink-entity-service-backend
  frontendImageName: quay.io/anonlink-test #data61/anonlink-entity-service-frontend
  docsImageName: quay.io/anonlink-test #data61/anonlink-entity-service-docs
  tutorialImageName: quay.io/anonlink-test #data61/anonlink-entity-service-tutorial
  benchmarkingImageName: quay.io/anonlink-test #data61/anonlink-entity-service-benchmarking

trigger:
- feature-azure-pipeline

pool:
  vmImage: "ubuntu-16.04"

steps:
- script: echo $(Build.SourceBranch) | tr [:upper:] [:lower:] | tr -cd [a-z] | xargs -I@ echo "##vso[task.setvariable variable=dockertag]@"
- bash: |
    docker build -t $(backendImageName):$dockertag ./backend
#- bash: |
#    docker build -t $(frontendImageName):$dockertag ./frontend
#- bash: |  
#    docker build -t $(docsImageName):$dockertag ./docs
#- bash: |
#    docker build -t $(tutorialImageName):$dockertag ./docs/tutorial
#- bash: |
#    docker build -t $(benchmarkingImageName):$dockertag ./benchmarking
    

#- stage: DockerCompose
#  displayName: Test deployment
#  dependsOn: DockerBuilds
#  condition: succeeded('DockerBuilds')
#  jobs:
#  - job: dockerComposeversion
  
